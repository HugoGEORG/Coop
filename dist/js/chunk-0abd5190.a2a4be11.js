(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0abd5190"],{"159b":function(t,s,e){var i=e("da84"),a=e("fdbc"),n=e("785a"),c=e("17c2"),o=e("9112"),l=function(t){if(t&&t.forEach!==c)try{o(t,"forEach",c)}catch(s){t.forEach=c}};for(var r in a)a[r]&&l(i[r]&&i[r].prototype);l(n)},"170d":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"columns is-multiline is-flex is-flex-direction-column is-justify-content-space-between",attrs:{id:"conversation"}},[e("div",{staticClass:"box column is-10 is-offset-1 has-text-centered",attrs:{id:"container-haut"}},[e("div",{staticClass:"has-text-right"},[e("button",{attrs:{id:"editButton"},on:{click:function(s){t.editingConv=!t.editingConv}}},[t.editingConv?e("i",{staticClass:"fa-2x fas fa-arrow-left"}):e("i",{staticClass:"fa-2x fa-solid fa-sliders"})])]),t.editingConv?e("form",{staticClass:"columns is-multiline",on:{submit:function(s){return s.preventDefault(),t.editConv(t.conv.id,t.conv.label,t.conv.topic)}}},[e("b-field",{staticClass:"column is-4 is-offset-4 mb-1 p-1",attrs:{horizontal:"",label:"Titre"}},[e("b-input",{attrs:{type:"text",autofocus:""},model:{value:t.conv.label,callback:function(s){t.$set(t.conv,"label",s)},expression:"conv.label"}})],1),e("b-field",{staticClass:"column is-4 is-offset-4 mb-1 p-1",attrs:{horizontal:"",label:"Topic"}},[e("b-input",{attrs:{type:"text",autofocus:""},model:{value:t.conv.topic,callback:function(s){t.$set(t.conv,"topic",s)},expression:"conv.topic"}}),e("button",{staticClass:"button",attrs:{id:"check"}},[e("i",{staticClass:"fas fa-check"})])],1)],1):e("div",[e("h1",{staticClass:"title"},[t._v(t._s(this.conv.label))]),e("h2",{staticClass:"subtitle mb-2"},[t._v(t._s(this.conv.topic))]),e("p",{staticClass:"mb-2"},[t._v(t._s(this.messages.length)+" messages")]),e("p",{staticClass:"is-size-7"},[t._v("Créé le: "+t._s(this.conv.created_at)+" "),this.conv.created_at!==this.conv.modified_at?e("span",[t._v("| Modifié le: "+t._s(this.conv.modified_at))]):t._e()])])]),e("div",{staticClass:"box px-5 column is-10 is-offset-1 is-flex is-flex-grow-2 is-flex-direction-column-reverse",attrs:{id:"chatbox"}},t._l(t.messages,(function(s){return e("div",{staticClass:"columns mb-2"},[e("un-message",{attrs:{message:s,id_channel:t.id_channel}})],1)})),0),e("div",{staticClass:"box column is-10 is-offset-1"},[e("form",{on:{submit:function(s){return s.preventDefault(),t.envoyerMessage.apply(null,arguments)}}},[e("b-field",[e("b-input",{staticStyle:{width:"100%"},attrs:{type:"text",autofocus:"",grouped:""},model:{value:t.nvMessage,callback:function(s){t.nvMessage=s},expression:"nvMessage"}}),e("b-button",{staticClass:"button",attrs:{id:"envoie"}},[e("i",{staticClass:"fa-solid fa-share"})])],1)],1)])])},a=[],n=(e("4160"),e("d3b7"),e("159b"),function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.message.member_id!==t.$store.state.member.id?e("div",{staticClass:"box mt-5 column is-5"},[t.message.auteur?e("router-link",{staticClass:"is-underlined",attrs:{to:{name:"FicheMembre",params:{id:t.message.auteur.id}}}},[t._v(t._s(t.message.auteur.fullname))]):e("p",{staticClass:"is-underlined"},[t._v("Utilisateur supprimé")]),e("p",{staticClass:"my-3 px-2 messageText"},[t._v(t._s(t.message.message))]),t.message.created_at===t.message.modified_at?e("p",{staticClass:"is-size-7 has-text-right"},[t._v("Écrit le "+t._s(t.message.created_at))]):e("p",{staticClass:"is-size-7 has-text-right"},[t._v("Modifié le "+t._s(t.message.modified_at))])],1):e("div",{staticClass:"box mt-5 column is-5 is-offset-7 has-background-info has-text-right has-text-white"},[e("div",{staticClass:"is-flex is-justify-content-space-between"},[t.editing?e("form",{staticClass:"is-flex is-justify-content-center mb-2"},[e("b-input",{attrs:{type:"text",autofocus:""},model:{value:t.message.message,callback:function(s){t.$set(t.message,"message",s)},expression:"message.message"}}),t._m(0)],1):e("p",{staticClass:"messageText has-text-left my-3 px-2"},[t._v(t._s(t.message.message))]),e("div",[t.editing?e("div",{staticClass:"is-flex is-align-items-start"},[e("button",{staticClass:"editButtons",on:{click:function(s){t.editing=!1}}},[e("i",{staticClass:"fas fa-arrow-left"})])]):e("div",{staticClass:"is-flex is-align-items-start"})])]),t.message.created_at===t.message.modified_at?e("p",{staticClass:"is-size-7 has-text-right"},[t._v("Écrit le "+t._s(t.message.created_at))]):e("p",{staticClass:"is-size-7 has-text-right"},[t._v("Modifié le "+t._s(t.message.modified_at))])])}),c=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("button",{staticClass:"button"},[e("i",{staticClass:"fas fa-check"})])}],o={name:"Message",props:["message","id_channel"],data:function(){return{editing:!1}},methods:{}},l=o,r=(e("f578"),e("2877")),u=Object(r["a"])(l,n,c,!1,null,"2468b307",null),f=u.exports,d={name:"Conversation",components:{unMessage:f},data:function(){return{id_channel:this.$route.params.id,conv:[],messages:[],members:[],nvMessage:"",editingConv:!1}},mounted:function(){var t=this;this.$api.get("members").then((function(s){t.members=s.data})),this.$api.get("channels/".concat(this.id_channel)).then((function(s){t.conv=s.data})),this.$api.get("channels/".concat(this.id_channel,"/posts")).then((function(s){t.messages=s.data,t.messages.forEach((function(s){s["auteur"]=t.recupAuteur(s.member_id)}))}))},methods:{envoyerMessage:function(){var t=this;if(this.nvMessage){var s={channel_id:this.id_channel,member_id:this.$store.state.member.id,message:this.nvMessage};this.$api.post("channels/".concat(this.id_channel,"/posts"),s).then((function(s){t.messages.unshift(s.data),t.nvMessage=""}))}else this.$buefy.toast.open("Renseigner un message !")},recupAuteur:function(t){var s;return this.members.forEach((function(e){e.id===t&&(s=e)})),s},editConv:function(t,s,e){var i=this;if(s)if(e){var a={label:s,topic:e};this.$api.put("channels/".concat(this.id_channel),a).then((function(t){i.$buefy.toast.open("Conversation modifié"),i.editingConv=!1}))}else this.$buefy.toast.open("Renseigner un topic !");else this.$buefy.toast.open("Renseigner un label !")}}},m=d,h=(e("357a"),Object(r["a"])(m,i,a,!1,null,"17ca53ce",null));s["default"]=h.exports},"17c2":function(t,s,e){"use strict";var i=e("b727").forEach,a=e("a640"),n=a("forEach");t.exports=n?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},"357a":function(t,s,e){"use strict";e("5d4f")},4160:function(t,s,e){"use strict";var i=e("23e7"),a=e("17c2");i({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},"46f5":function(t,s,e){},"5d4f":function(t,s,e){},a640:function(t,s,e){"use strict";var i=e("d039");t.exports=function(t,s){var e=[][t];return!!e&&i((function(){e.call(null,s||function(){throw 1},1)}))}},f578:function(t,s,e){"use strict";e("46f5")}}]);
//# sourceMappingURL=chunk-0abd5190.a2a4be11.js.map